@page
@model TurismoNeuquen.Pages.AddPoiModel
<h1>Añadir Poi</h1>

<form method="post" asp-page-handler="AddPOI">
    <label for="poiType">Tipo de POI:</label>
    <select id="poiType" name="poiType" onchange="showFields()">
        <option value="attraction">Atracción</option>
        <option value="event">Evento</option>
    </select>

    <!-- Common fields -->
    <input type="text" name="Name" placeholder="Nombre" required />
    <input type="text" name="Description" placeholder="Descripción" required />
    <input type="text" step="any" name="Latitude" placeholder="Latitud" required />
    <input type="text" step="any" name="Longitude" placeholder="Longitud" required />

    <!-- Attraction-specific fields -->
    <div id="attractionFields" style="display: none;">
        <fieldset>
            <legend>Días de apertura:</legend>
            <label>
                <input type="checkbox" class="dayCheckbox" value="0" onchange="updateOpenDays()" /> Lunes
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="1" onchange="updateOpenDays()" /> Martes
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="2" onchange="updateOpenDays()" /> Miércoles
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="3" onchange="updateOpenDays()" /> Jueves
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="4" onchange="updateOpenDays()" /> Viernes
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="5" onchange="updateOpenDays()" /> Sábado
            </label>
            <label>
                <input type="checkbox" class="dayCheckbox" value="6" onchange="updateOpenDays()" /> Domingo
            </label>
        </fieldset>
        <input type="hidden" name="OpenDays" id="OpenDays" />
        <input type="time" name="OpeningTime" placeholder="Hora de apertura" required />
        <input type="time" name="ClosingTime" placeholder="Hora de cierre" required />
    </div>

    <!-- Event-specific fields -->
    <div id="eventFields" style="display: none;">
        <input type="datetime-local" name="EventDate" placeholder="Fecha del evento" />
        <input type="text" name="Location" placeholder="Ubicación" />
    </div>

    <button type="submit">Añadir</button>
</form>

<script>
    function showFields() {
        const poiType = document.getElementById("poiType").value;
        document.getElementById("attractionFields").style.display = poiType === "attraction" ? "block" : "none";
        document.getElementById("eventFields").style.display = poiType === "event" ? "block" : "none";
    }

    function updateOpenDays() {
        const checkboxes = document.querySelectorAll('.dayCheckbox');
        let openDaysBinary = '';

        checkboxes.forEach((checkbox, index) => {
            openDaysBinary += checkbox.checked ? '1' : '0';
        });

        document.getElementById('OpenDays').value = openDaysBinary;
    }

    // Initial call to set the correct fields when the page loads
    showFields();
</script>